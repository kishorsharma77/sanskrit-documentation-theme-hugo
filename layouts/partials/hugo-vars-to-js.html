<script type="text/javascript">
  let pageSource = "{{.File.Path}}";
  console.log(pageSource);
  let baseURL = "{{.Site.BaseURL}}";
  let siteParams = JSON.parse("{{.Site.Params | jsonify}}");
  let pageParams = JSON.parse("{{.Page.Params | jsonify}}");
  let pageDefaultsList = JSON.parse({{.Site.Data.page_defaults | jsonify}});
  let sidebarsData = JSON.parse("{{$.Site.Data.sidebars | jsonify}}");
  var pageDefaults;
  for (let possiblePageDefaults of pageDefaultsList) {
    if (pageSource.startsWith(possiblePageDefaults.scope.pathPrefix)) {
      pageDefaults = possiblePageDefaults.values
    }
  }
  var sidebarId = pageParams.sidebar || pageDefaults.sidebar;
  // console.debug(pageParams);
  let autocompletePageUrl = "{{ "data/pages.tsv" | relURL }}";

  var pageUrlToTitle = {};
  // Note that only pages parsed and generated by jekyll are processed below - not ready files like pdf-s and htmls.
  {{ range $.Site.Pages  }}
  pageUrlToTitle["{{.URL}}"] = "{{.Params.title}}";
  {{ end }}

  // For directory listing:
  var pageDirectoryToUrl = {};
  for (var pageUrl in pageUrlToTitle) {
      if(pageUrlToTitle.hasOwnProperty(pageUrl)) {
          var dirPath = pageUrl.split("/").slice(0,-1).join("/");
          if (pageDirectoryToUrl.hasOwnProperty(dirPath)) {
              pageDirectoryToUrl[dirPath].push(pageUrl);
          } else {
              pageDirectoryToUrl[dirPath] = [pageUrl];
          }
      }
  }

</script>
