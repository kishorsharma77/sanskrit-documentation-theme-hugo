<script type="text/javascript">
    // Note that this file should not contain definitions for page-specific variables. Reason: Hugo builds this partial just once and includes it everywhere.
    let baseURL = "{{.Site.BaseURL}}";
    let basePath = "/" + baseURL.split("/").slice(3).join("/");
    let siteParams = JSON.parse("{{.Site.Params | jsonify}}");
    let pageDefaultsList = JSON.parse("{{.Site.Data.page_defaults | jsonify}}");
    let sidebarsData = JSON.parse("{{$.Site.Data.sidebars | jsonify}}");
    let autocompletePageUrl = "{{ "data/pages.tsv" | relURL }}";
    // For directory listing:
    var pageRelUrlTree = {};
    
    function finalizePageParams(pageParams, absUrl) {
        if(pageParams == "null" || pageParams == null) {
            pageParams = {};
        }
        pageParams["absUrl"] = absUrl;
        return pageParams;
    }

    {
        // Note that only pages parsed and generated by the site generator are processed below - not ready files like pdf-s and htmls.
        // PS: .RelPermalink includes the subpath bit of the baseUrl, hence we subtract it from absUrl.
        let pageParams = {};
        let fileParams = {};
        {{ range $.Site.Pages  }} {{ $absUrl := .RelPermalink | absURL }}{{ $urlMinusBase := replace $absUrl .Site.BaseURL "/" }}
        pageParams = JSON.parse("{{.Params | jsonify}}") || {};
        pageParams["logicalName"] = "{{.File.LogicalName}}";
        module_dir_tree.addRelUrlToTree("{{$urlMinusBase}}", finalizePageParams(pageParams, "{{ $absUrl }}"));
        {{ end }}
    }
</script>
